<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Flappy Arcade (Pixel Edition)</title>
<style>
  @import url('https://fonts.googleapis.com/css2?family=Press+Start+2P&display=swap');

  html, body {
    margin: 0;
    padding: 0;
    height: 100%;
    background: linear-gradient(to right, #EAECC6, #2BC0E4);
    font-family: 'Press Start 2P', cursive;
    overflow: hidden;
  }

  canvas {
    display: block;
    width: 100vw;
    height: 100vh;
    touch-action: manipulation;
  }

  #soundButton {
    position: fixed;
    top: 16px;
    right: 16px;
    z-index: 10;
    background: rgba(0, 0, 0, 0.45);
    color: white;
    border: none;
    font-size: calc(1.4vw + 10px);
    border-radius: 50%;
    padding: 10px;
    cursor: pointer;
  }

  #uiBox {
    position: absolute;
    top: 16px;
    left: 16px;
    z-index: 10;
    background: linear-gradient(to right, #FFC837, #FF8008);
    padding: 8px 12px;
    border-radius: 10px;
    font-size: calc(1vw + 8px);
    text-align: left;
    color: #111;
  }

  .menu-box {
    position: absolute;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    background: linear-gradient(to right, #DDEFBB, #FFEEEE);
    border-radius: 12px;
    padding: 24px 32px;
    text-align: center;
    box-shadow: 0 6px 18px rgba(0, 0, 0, 0.25);
    z-index: 11;
    max-width: 90%;
  }

  .menu-box h1 {
    margin: 0 0 10px;
    color: #ff5722;
    font-size: calc(2vw + 16px);
  }

  .menu-box p {
    font-size: calc(1vw + 6px);
    margin-bottom: 15px;
  }

  .menu-box button {
    background: #ff5722;
    color: white;
    border: none;
    padding: 10px 22px;
    font-size: calc(1vw + 10px);
    border-radius: 8px;
    cursor: pointer;
  }

  .menu-box button:hover {
    background: #ff784e;
  }

  .flappy-logo {
    display: inline-block;
    letter-spacing: 4px;
    line-height: 1;
    text-transform: uppercase;
    white-space: nowrap;
  }

  .flappy-logo .letter {
    display: inline-block;
    font-size: calc(3vw + 20px);
    padding: 2px 1px;
    margin: 0 1px;
    color: #fff;
    -webkit-text-stroke: 2px #000;
    text-shadow: 2px 2px 0 #000;
  }

  footer {
    position: fixed;
    bottom: 0;
    width: 100%;
    background: linear-gradient(to right, #A5FECB, #20BDFF, #5433FF);
    text-align: center;
    font-size: calc(0.8vw + 8px);
    padding: 6px 0;
    z-index: 15;
    color: white;
    letter-spacing: 0.4px;
  }

  footer strong {
    color: #ffd700;
  }

  footer a {
    color: #ffd700;
    text-decoration: none;
  }

  footer a:hover {
    text-decoration: underline;
  }
</style>
</head>
<body>
<canvas id="gameCanvas"></canvas>

<div id="uiBox">Score: 0 | High Score: 0 | Time: 0:00</div>
<button id="soundButton">ðŸ”Š</button>

<div id="startMenu" class="menu-box">
  <h1 id="flappyLogo" class="flappy-logo" aria-hidden="true"></h1>
  <p>Collect coins for +5 points!</p>
  <button id="startBtn">START GAME</button>
</div>

<div id="restartMenu" class="menu-box" style="display:none;">
  <h1>ðŸ’€ GAME OVER ðŸ’€</h1>
  <p id="finalScore">Score: 0</p>
  <button id="restartBtn">RESTART</button>
</div>

<footer>
  ðŸŽ® Created by: <strong>Dharam Rathod, Paras Bamaniya, Nikunj Jagatiya</strong> | Flappy Dogesh Â© 2025
</footer>

<script>
/* === Setup === */
const canvas = document.getElementById('gameCanvas');
const ctx = canvas.getContext('2d');
const uiBox = document.getElementById('uiBox');
const soundButton = document.getElementById('soundButton');
const startMenu = document.getElementById('startMenu');
const restartMenu = document.getElementById('restartMenu');
const finalScore = document.getElementById('finalScore');

ctx.imageSmoothingEnabled = false; // pixel style

const baseVisibleHeight = 112;
let scale = 1, groundY = 0;

function resizeCanvas() {
  canvas.width = innerWidth;
  canvas.height = innerHeight;
  scale = Math.min(innerWidth / 480, innerHeight / 640);
  groundY = canvas.height - baseVisibleHeight * scale;
}
window.addEventListener('resize', resizeCanvas);

/* === Assets === */
const img = (url) => { const i = new Image(); i.crossOrigin = "anonymous"; i.src = url; return i; };

const charImg = img("https://i.postimg.cc/Yvzmkd6K/Whats-App-Image-2025-11-07-at-6-40-03-PM-removebg-preview.png");
const bgImg = img("https://i.postimg.cc/VrQTM9Zy/Whats-App-Image-2025-11-07-at-7-41-23-PM-removebg-preview.png");
const baseImg = img("https://i.ibb.co/V7vh8Hv/base-img.png");
const pipeImg = img("https://raw.githubusercontent.com/sourabhv/FlapPyBird/master/assets/sprites/pipe-green.png");
const coinImg = img("https://i.postimg.cc/4YghrD9N/Whats-App-Image-2025-11-07-at-6-34-56-PM-removebg-preview.png");

/* === Sounds === */
const sounds = {
  flap: new Audio("https://archive.org/download/fart-with-reverb-39675/fart-with-reverb-39675.mp3"),
  coin: new Audio("https://archive.org/download/disgusting-chewing-46456/disgusting-chewing-46456.mp3"),
  die: new Audio("https://archive.org/download/old-dog-howling-390287/old-dog-howling-390287.mp3"),
  bg: new Audio("https://archive.org/download/cartoon-funny-music-430820/cartoon-funny-music-430820.mp3")
};
sounds.bg.loop = true; sounds.bg.volume = 0.9;
let soundEnabled = true, soundUnlocked = false;

function unlockSound() {
  if (soundUnlocked) return;
  // attempt to play background to unlock audio on mobile
  sounds.bg.play().then(() => {
    soundUnlocked = true;
    if (!soundEnabled) sounds.bg.pause();
  }).catch(() => {
    // user gesture required; nothing else needed
  });
}
document.addEventListener('click', unlockSound, { once: true });
document.addEventListener('touchstart', unlockSound, { once: true });

soundButton.onclick = () => {
  soundEnabled = !soundEnabled;
  soundButton.textContent = soundEnabled ? 'ðŸ”Š' : 'ðŸ”‡';
  if (soundEnabled && soundUnlocked) {
    sounds.bg.currentTime = sounds.bg.currentTime || 0;
    sounds.bg.play().catch(() => {});
  } else {
    sounds.bg.pause();
  }
};

/* === Game Vars === */
let bird, pipes, coins, score, highScore, baseX, frame, started, dying, gameOver, startTime;
const gravity = 0.5, jump = -8, gap = 152;
let pipeGapX = 280;

/* === Init === */
function init() {
  resizeCanvas();
  bird = { x: 99 * scale, y: canvas.height / 6, vy: 0, r: 20 * scale };
  pipes = []; coins = []; frame = 0; score = 0; dying = false; gameOver = false; started = false;
  baseX = 0; highScore = parseInt(localStorage.getItem('flappyHighScore') || '0', 10);
  uiBox.innerText = Score: ${score} | High Score: ${highScore} | Time: 0:00;
  startMenu.style.display = 'block'; restartMenu.style.display = 'none';
  startTime = null;
  if (soundEnabled && soundUnlocked) { sounds.bg.currentTime = 0; sounds.bg.play().catch(()=>{}); }
}
init();

/* === Controls === */
function flap() {
  if (!started || gameOver || dying) return;
  bird.vy = jump * scale;
  if (soundEnabled) { sounds.flap.currentTime = 0; sounds.flap.play().catch(() => {}); }
}
document.addEventListener('keydown', e => { if (e.code === 'Space') flap(); });
canvas.addEventListener('click', () => { if (started) flap(); });
document.addEventListener('touchstart', (e) => { 
  // if the start menu is visible and touch occurs on start button, leave it to startBtn handler
  if (started) flap(); 
}, { passive: true });

document.getElementById('startBtn').onclick = () => {
  started = true; startMenu.style.display = 'none';
  startTime = Date.now();
  if (soundEnabled && soundUnlocked) sounds.bg.play().catch(()=>{});
  requestAnimationFrame(update);
};
document.getElementById('restartBtn').onclick = () => { restartMenu.style.display = 'none'; init(); };

/* === Pipes === */
function makePipe() {
  const minTop = 60 * scale;
  const maxTop = canvas.height - gap * scale - 150 * scale;
  const top = Math.max(minTop, Math.random() * (maxTop - minTop) + minTop);
  pipes.push({ x: canvas.width, top, passed: false, w: 70 * scale });
  if (Math.random() > 0.45) {
    const coinY = top + (gap * scale) / 4;
    coins.push({ x: canvas.width + 40 * scale, y: coinY, r: 18 * scale, collected: false });
  }
}

/* === Base === */
function drawBase() {
  baseX -= 4 * scale;
  const actualW = baseImg.naturalWidth || 500;
  const actualH = baseImg.naturalHeight || 100;
  const baseW = actualW * scale;
  const visibleH = baseVisibleHeight * scale;
  if (baseW === 0) return; // safety if image not loaded yet
  if (baseX <= -baseW) baseX = 0;
  for (let i = 0; i < Math.ceil(canvas.width / baseW) + 1; i++) {
    const x = baseX + i * baseW;
    ctx.drawImage(baseImg, 0, actualH - baseVisibleHeight, actualW, baseVisibleHeight, x, groundY, baseW, visibleH);
  }
}

/* === Update === */
function update() {
  ctx.clearRect(0, 0, canvas.width, canvas.height);
  if (bgImg.complete) ctx.drawImage(bgImg, 0, 0, canvas.width, canvas.height);

  // spawn pipes if needed
  if (pipes.length === 0 || pipes[pipes.length - 1].x < canvas.width - pipeGapX * scale) makePipe();

  if (!dying) bird.vy += gravity * scale;
  bird.y += bird.vy;

  for (const p of pipes) {
    p.x -= 2 * scale;
    if (!p.passed && p.x + p.w / 2 < bird.x) { p.passed = true; score++; }
  }

  for (const c of coins) {
    c.x -= 2 * scale;
    if (!c.collected) {
      const dx = bird.x - c.x, dy = bird.y - c.y;
      if (Math.hypot(dx, dy) < bird.r + c.r) {
        c.collected = true; score += 5;
        if (soundEnabled) { sounds.coin.currentTime = 0; sounds.coin.play().catch(() => {}); }
      }
    }
  }

  // draw pipes
  for (const p of pipes) {
    const w = p.w;
    const pImgW = pipeImg.naturalWidth || 52;
    const pImgH = pipeImg.naturalHeight || 320;
    const drawH = pImgH * (w / pImgW);
    // top pipe (flip)
    ctx.drawImage(pipeImg, p.x, p.top - drawH, w, drawH);
    // bottom pipe
    ctx.drawImage(pipeImg, p.x, p.top + gap * scale, w, drawH);
  }

  // draw coins
  for (const c of coins) {
    if (!c.collected && coinImg.complete) ctx.drawImage(coinImg, c.x - c.r, c.y - c.r, c.r * 2, c.r * 2);
  }

  // draw bird (if loaded, otherwise draw circle)
  if (charImg.complete) {
    ctx.drawImage(charImg, bird.x - bird.r, bird.y - bird.r, 60 * scale, 60 * scale);
  } else {
    ctx.beginPath();
    ctx.fillStyle = '#FFDD55';
    ctx.arc(bird.x, bird.y, bird.r, 0, Math.PI * 2);
    ctx.fill();
  }

  drawBase();

  // update UI time safely (startTime may be null until game started)
  let timeText = "0:00";
  if (startTime) {
    const elapsed = Math.floor((Date.now() - startTime) / 1000);
    const mins = Math.floor(elapsed / 60);
    const secs = (elapsed % 60).toString().padStart(2, '0');
    timeText = ${mins}:${secs};
  }
  uiBox.innerText = Score: ${score} | High Score: ${highScore} | Time: ${timeText};

  if (!dying) {
    for (const p of pipes) {
      if (bird.x + bird.r > p.x && bird.x - bird.r < p.x + p.w) {
        if (bird.y - bird.r < p.top || bird.y + bird.r > p.top + gap * scale) triggerDie();
      }
    }
    if (bird.y + bird.r >= groundY || bird.y - bird.r < 0) triggerDie();
  }

  if (dying) {
    bird.vy += gravity * scale * 1.5;
    if (bird.y + bird.r >= groundY) {
      bird.y = groundY - bird.r; dying = false; gameOver = true;
      if (score > highScore) { highScore = score; localStorage.setItem('flappyHighScore', highScore); }
      showGameOver(); return;
    }
  }

  // cleanup off-screen objects
  pipes = pipes.filter(p => p.x + p.w > -50);
  coins = coins.filter(c => c.x > -100 && !c.collected);

  if (!gameOver) requestAnimationFrame(update);
}

/* === GameOver === */
function triggerDie() {
  if (!dying) {
    dying = true;
    if (soundEnabled) { sounds.die.currentTime = 0; sounds.die.play().catch(() => {}); }
  }
}

function showGameOver() {
  if (soundEnabled && soundUnlocked) sounds.bg.pause();
  finalScore.innerText = Score: ${score} | High Score: ${highScore};
  restartMenu.style.display = 'block';
}

/* === Title === */
const titleText = " FLAPPY DOGESH ";
const titleColors = ["#f1e26d", "#e76aa0", "#bfe7ff", "#6f6bff", "#9ee072", "#d17fb6", "#e0e26d", "#97d6ff", "#ffffff"];
const logo = document.getElementById('flappyLogo');
logo.innerHTML = "";
for (let i = 0; i < titleText.length; i++) {
  const ch = titleText[i];
  const span = document.createElement('span');
  span.className = 'letter';
  span.textContent = ch;
  if (ch !== ' ') span.style.color = titleColors[i % titleColors.length];
  logo.appendChild(span);
}

console.log("Flappy Arcade (Pixel Edition) ready!");
</script>
</body>
</html>

